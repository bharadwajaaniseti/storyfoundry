```
╔══════════════════════════════════════════════════════════════════════════════╗
║                      LANGUAGE STORAGE ARCHITECTURE                           ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                           SUPABASE STORAGE                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  📦 language-symbols/                                                       │
│  ├─ Purpose: Writing system glyphs, symbols, characters                    │
│  ├─ Limit: 5MB per file                                                    │
│  ├─ Used in: Script Tab → Symbol image uploads                            │
│  │                                                                          │
│  ├─ 📁 {language-id-1}/                                                    │
│  │   ├─ 🖼️ abc-123-uuid.png       (Symbol: 'あ')                          │
│  │   ├─ 🖼️ def-456-uuid.svg       (Symbol: 'か')                          │
│  │   └─ 🖼️ ghi-789-uuid.jpg       (Symbol: 'さ')                          │
│  │                                                                          │
│  ├─ 📁 {language-id-2}/                                                    │
│  │   ├─ 🖼️ jkl-012-uuid.png       (Symbol: 'α')                           │
│  │   └─ 🖼️ mno-345-uuid.svg       (Symbol: 'β')                           │
│  │                                                                          │
│  └─ 📁 {language-id-3}/                                                    │
│      └─ 🖼️ pqr-678-uuid.webp      (Symbol: '∞')                           │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  📦 language-images/                                                        │
│  ├─ Purpose: Reference images, calligraphy, grammar charts                 │
│  ├─ Limit: 10MB per file                                                   │
│  ├─ Used in: Media Tab → Multi-image gallery uploads                      │
│  │                                                                          │
│  ├─ 📁 {language-id-1}/                                                    │
│  │   ├─ 🖼️ sample-1-uuid.jpg      (Calligraphy sample)      [COVER]      │
│  │   ├─ 🖼️ chart-1-uuid.png       (Grammar rules chart)                   │
│  │   └─ 🖼️ reference-1-uuid.webp  (Historical reference)                  │
│  │                                                                          │
│  ├─ 📁 {language-id-2}/                                                    │
│  │   ├─ 🖼️ alphabet-uuid.jpg      (Alphabet chart)          [COVER]      │
│  │   ├─ 🖼️ writing-uuid.png       (Writing sample)                        │
│  │   └─ 🖼️ phonetic-uuid.gif      (Pronunciation guide)                   │
│  │                                                                          │
│  └─ 📁 {language-id-3}/                                                    │
│      ├─ 🖼️ old-text-uuid.jpg      (Ancient text sample)     [COVER]      │
│      └─ 🖼️ evolution-uuid.png     (Language evolution chart)              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                        SECURITY POLICIES (RLS)                               ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│ 👁️  PUBLIC READ ACCESS                                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│ ✅ Anyone can view images                                                   │
│ ✅ No authentication required                                               │
│ ✅ Enables sharing language references                                      │
│ ✅ CDN-optimized delivery                                                   │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 🔐 AUTHENTICATED WRITE ACCESS                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│ ✅ Only logged-in users can upload                                          │
│ ✅ Prevents anonymous spam                                                  │
│ ✅ File type validation (images only)                                       │
│ ✅ Size limits enforced (5MB/10MB)                                          │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 👤 OWNER-ONLY MODIFICATION                                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│ ✅ Users can only update/delete their own language's images                 │
│ ✅ Folder name checked against language ownership                           │
│ ✅ Prevents unauthorized file manipulation                                  │
│ ✅ Protects user data                                                       │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                            UPLOAD WORKFLOW                                   ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                        SCRIPT TAB (Single Symbol)                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. User clicks "Upload Image" on symbol card                              │
│  2. File picker opens (single file)                                        │
│  3. Validate file is an image                                              │
│  4. Generate UUID filename: {uuid}.{ext}                                   │
│  5. Upload to: language-symbols/{languageId}/{uuid}.{ext}                  │
│  6. Get public URL                                                         │
│  7. Update symbol.image in form                                            │
│  8. Trigger auto-save (600ms debounce)                                     │
│  9. Show success toast                                                     │
│  10. Display image preview in symbol card                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                        MEDIA TAB (Multiple Images)                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. User clicks "Upload Image" button                                      │
│  2. File picker opens (multiple selection enabled)                         │
│  3. Validate each file is an image                                         │
│  4. Show "Uploading X image(s)" toast                                      │
│  5. For each file:                                                         │
│     a. Generate UUID filename                                              │
│     b. Upload to: language-images/{languageId}/{uuid}.{ext}                │
│     c. Get public URL                                                      │
│     d. Create image object: {id, url, caption, isCover}                    │
│  6. Add all uploaded images to form.images[]                               │
│  7. Trigger auto-save                                                      │
│  8. Show success toast                                                     │
│  9. Update gallery grid display                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                        GALLERY FEATURES                                      ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                           IMAGE GRID                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Layout: 2 → 3 → 4 columns (responsive)                                    │
│  Cards: Square aspect ratio (1:1)                                          │
│  Loading: Lazy loading (loading="lazy")                                    │
│                                                                             │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐                             │
│  │ [COVER]│ │        │ │        │ │        │                             │
│  │  📷    │ │  📷    │ │  📷    │ │  📷    │                             │
│  │ Image1 │ │ Image2 │ │ Image3 │ │ Image4 │                             │
│  │ ⋮ menu │ │ ⋮ menu │ │ ⋮ menu │ │ ⋮ menu │                             │
│  │Caption │ │Caption │ │Caption │ │Caption │                             │
│  └────────┘ └────────┘ └────────┘ └────────┘                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                        IMAGE ACTIONS MENU                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Hover → Show menu (⋮)                                                     │
│  Click → Dropdown opens:                                                   │
│                                                                             │
│    ✓ Set as Cover      → Mark as primary image                            │
│    ───────────────                                                         │
│    🗑️ Remove           → Delete from gallery                               │
│                                                                             │
│  Auto-save triggers after each action                                      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                        FILE NAMING CONVENTION                                ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│ Pattern: {languageId}/{uuid}.{extension}                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│ Example:                                                                    │
│   language-symbols/                                                         │
│     550e8400-e29b-41d4-a716-446655440000/                                  │
│       abc-123-def-456-ghi-789.png                                          │
│       ^^^^^^^^^^^^^^^^^^^^^^^^^^^                                          │
│       UUID prevents filename conflicts                                     │
│                                                                             │
│ Benefits:                                                                   │
│   ✅ Unique filenames (no overwrites)                                       │
│   ✅ Organized by language (easy cleanup)                                   │
│   ✅ Security via folder ownership check                                    │
│   ✅ Supports bulk operations                                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                      SUPPORTED FILE TYPES                                    ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│ Format        │ MIME Type          │ Max Size │ Best For                   │
├───────────────┼────────────────────┼──────────┼────────────────────────────┤
│ PNG           │ image/png          │ 5/10MB   │ Crisp symbols, transparency│
│ JPEG/JPG      │ image/jpeg         │ 5/10MB   │ Photos, samples            │
│ SVG           │ image/svg+xml      │ 5/10MB   │ Vector glyphs, scalable    │
│ WebP          │ image/webp         │ 5/10MB   │ Modern, compressed         │
│ GIF           │ image/gif          │ 5/10MB   │ Simple animations          │
└─────────────────────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                          QUICK REFERENCE                                     ║
╚══════════════════════════════════════════════════════════════════════════════╝

Setup Commands:
  $ node create-language-storage.js         # Create buckets
  # Then run SQL file in Supabase Dashboard

Code Usage:
  // Upload to symbols bucket
  supabase.storage.from('language-symbols').upload(path, file)
  
  // Upload to images bucket
  supabase.storage.from('language-images').upload(path, file)
  
  // Get public URL
  supabase.storage.from('bucket-name').getPublicUrl(path)

Database Storage:
  world_elements.attributes.symbols[].image    → Symbol image URLs
  world_elements.attributes.images[]           → Gallery image objects

Documentation:
  📖 LANGUAGE_STORAGE_SETUP.md               → Full guide
  🚀 LANGUAGE_STORAGE_QUICKSTART.md          → 2-minute setup
  ✅ LANGUAGE_STORAGE_COMPLETE.md            → Implementation summary

╔══════════════════════════════════════════════════════════════════════════════╗
║                            STATUS: READY ✅                                  ║
╚══════════════════════════════════════════════════════════════════════════════╝
```
